{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP\\\\Desktop\\\\coding-files\\\\projects\\\\web-chat-app\\\\client\\\\src\\\\asset\\\\MobileViewFolder\\\\MobileChatList.js\",\n    _s = $RefreshSig$();\n\nimport { useContext, useEffect, useRef, useState } from \"react\";\nimport { FaAdn, FaCheck, FaExclamationCircle, FaRegBell, FaSistrix } from \"react-icons/fa\";\nimport './MobileChatList.css';\nimport axios from 'axios';\nimport { OtherUserNameContext } from \"../contextFolder/OtherUserNameContext\";\nimport { MessageDisplayContext } from \"../contextFolder/MessageDisplayContext\";\nimport { ProfileDisplayContext } from \"../contextFolder/ProfileDisplayContext\";\nimport { SettingsDisplayContext } from \"../contextFolder/SettingsDisplayContext\";\nimport { useNavigate } from \"react-router-dom\";\nimport { AddUserToChatListContext } from \"../contextFolder/AddUserToChatListContext\";\nimport { NotificationContext } from \"../contextFolder/NotificationContext\";\nimport socket from '../SocketModuleFolder/socket';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction MobileChatList() {\n  _s();\n\n  //Let's get the name of the user that logged in (which is you)\n  //from the session storage . .  . . . . . . . . . . . . . . .\n  let loggedInNameValue = JSON.parse(sessionStorage.getItem(\"username\")); //SOCKET AS DEPENDENCY FOR USEEFFECT FOR THIS COMPONENT. . . . . . . . . . . . . . . . . .\n\n  useEffect(() => {\n    const matchResult = window.matchMedia(\"(max-width: 767px)\");\n\n    if (matchResult.matches === true) {\n      socket.emit(\"small-screen-connection\", {\n        smallScreenAlert: loggedInNameValue + \"is on smaller screen\"\n      });\n    }\n  }, [socket]); //THIS RECEIVES MY   NOTIFICATION WHEN IT'S BEEN TRIGGER IN SERVER\n\n  useEffect(() => {\n    //Listenning for new notification and then adding it to our notification\n    //array. But first check if the person to add to notification is not the\n    //same as the current person we're chatting with which is the value \n    //otherUserNameValue variable holds\n    socket.on(\"myNotification\", data => {\n      if (data.personToAddToNotificationList !== otherUserNameValue) {\n        setNotificationValue(prevState => [...prevState, data.personToAddToNotificationList]);\n      }\n    });\n  }, [socket]); //-------- [ OUR USEREF FOR THIS COMPONENT... ] --------//\n  //THIS IS FOR OUR SCROLLABLE CHAT list      \n\n  const scrollableChatListRef = useRef(); //THIS IS FOR THE FILTERING OF SEARCH DIV\n\n  const filterParentContainerRef = useRef(); //THIS IS FOR THE CONVERSED WITH DIV\n\n  const conversedWithParentContainerRef = useRef(); //THIS IF HANDLING HIDING UNREAD MESSAGE ICON\n\n  const unReadRef = useRef(); //THIS HIDES THE FILTER PARENT CONTAINER DIV ONCE A USER THAT \n  //DISPLAY ON SEARCH LIST IS CLICKED ON . . . . . . \n\n  const hideFilterParentContainerRef = () => {\n    filterParentContainerRef.current.style.display = \"none\";\n    conversedWithParentContainerRef.style.display = \"true\";\n  }; //THIS SHOWS FILTERED PARENT CONTAINER WHEN YOU START SEARCHING\n  //FOR USER IN THE SEARCH BOX. . . . . . . . . . . . \n\n\n  const showFilterParentContainerRef = () => {\n    filterParentContainerRef.current.style.display = \"block\"; //     conversedWithParentContainerRef.style.display = \"none\"\n  }; //THIS REMOVES USER FROM YOUR NOTIFICATION LIST WHEN THEY ARE CLICKED\n  //ON . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n\n  const handleRemovingThisUserFromNotificationList = thisUser => {\n    setNotificationValue([]); //first let's empty the notification array.\n    //Let's then send the name of the person we want to remove to\n    //our DB then return the remaining people in our saved notification\n    //list in the database then put that value in the notification array. \n\n    axios.post(\"http://localhost:4000/removeThisUserNotification\", {\n      loggedInUser: loggedInNameValue,\n      personToRemove: thisUser\n    }).then(result => {\n      if (result) {\n        result.data.forEach(resData => {\n          let addThis = resData.personToAddToNotificationList; //when we get the result of people in our notification list,\n          //let's add them to our notification array and also (don't\n          //add people that already exist in the array to prevent name\n          //appearing twice which will affect the length of the array.\n          //mind you, the length of the array will we used to count how\n          //many notification we have . . . . . . . . . . . . . . . .)\n\n          if (!notificationValue.includes(addThis)) {\n            setNotificationValue(prevState => [...prevState, addThis]);\n          }\n        });\n      }\n    }).catch(err => {\n      console.log(err);\n    }); //This hides the notification alert symbol icon that shows close to user\n\n    unReadRef.current.style.display = \"none\";\n  }; //---------- [ CONTEXT API FOR THIS FILE... ] ----------//\n\n\n  const {\n    otherUserNameValue,\n    setOtherUserNameValue\n  } = useContext(OtherUserNameContext); //Displays message component when you click on list of conversed with user\n\n  const {\n    messageDisplayValue,\n    setMessageDisplayValue\n  } = useContext(MessageDisplayContext);\n  const {\n    profileDisplayValue,\n    setProfileDisplayValue\n  } = useContext(ProfileDisplayContext);\n  const {\n    settingsDisplayValue,\n    setSettingsDisplayValue\n  } = useContext(SettingsDisplayContext); //adding someone to your chatlist when they message you.\n\n  const {\n    addUserToChatListValue,\n    setAddUserToChatListValue\n  } = useContext(AddUserToChatListContext); //This hold the value for every notification we've. It stores the user that  \n  //sent use message and have'nt responded to.\n\n  const {\n    notificationValue,\n    setNotificationValue\n  } = useContext(NotificationContext); //If on large screen, this makes sure the message component is what is \n  //visible (not the profile or setting component) .  . . . . . . . \n\n  const clickMessage = () => {\n    setProfileDisplayValue(false);\n    setSettingsDisplayValue(false);\n    setMessageDisplayValue(true);\n  };\n\n  if (notificationValue) {\n    console.log('new chatlist' + notificationValue);\n  } else {\n    console.log(\"dont new list\");\n  }\n  /* - - - - - [ALL USESTATE FOR THIS PARTICULAR COMPONENT] - - - - - */\n  //This is for navigating to chat message room (when on small screen)\n\n\n  const navigate = useNavigate(); //This will help us storing the list of user that we've conversed with\n\n  const [conversedWithLists, setConversedWithLists] = useState([]); //This setFilteredData will store the filtered element based on the user\n  //search input and then store it in the filteredData variable so we can\n  //map it\n\n  const [filteredData, setFilteredData] = useState([]); //This is used for capturing what the user types into the search box\n\n  const [searchWord, setSearchWord] = useState();\n  /* - - - - - [ALL OUR FUNCTIONS FOR THIS PARTICULAR COMPONENT] - - - - -*/\n  //This is to store what the user type in the search box so we can\n  //use for filtering and also filter the name of user in realtime \n  //based on serach input\n\n  const onChangeFunction = event => {\n    //This will grab the value in the user type in the input box and store it in the searchFilter state\n    //please note: the toLowerCase() will convert the value to lowercase so that it can match with the\n    //lowercase name properties in the database. (we'd convert all name properties in DB to lowercase too)\n    setSearchWord(event.target.value.toLowerCase()); //This will filter out users that matches the character inputted by the user in realtime\n    //and then store it in the newFilter variable. please note: the toLowerCase() will convert the value of the\n    // DB name property to lowercase so that it can match with the value from the search input which we already \n    //convertted to lowercase using the toLowercase() method.\n    //Here we're returning users that their names matches with the value the user is inputting as they\n    //are typing it out on the go...\n\n    if (searchWord) {\n      axios.post(\"http://localhost:4000/searchAllUsers\", {\n        searchInput: searchWord.toLowerCase()\n      }).then(response => {\n        console.log(response.data);\n        response.data.forEach(resData => {\n          let name = resData; //Here let check if filteredData already have this user stored in it already \n          //to avoid duplicate display of names that already exist in this array.\n\n          let checkIfThisUserExistUsingItName = filteredData.some(object => object === name);\n\n          if (!checkIfThisUserExistUsingItName) {\n            setFilteredData([{\n              name: name\n            }]);\n          }\n        });\n      }).catch(error => {\n        console.log(\"oops! Couldn't reach the server\" + error);\n      });\n    }\n\n    if (!searchWord || searchWord === \" \") {\n      hideFilterParentContainerRef();\n    } //This shows the filters parent container whenonChange of the input search box\n\n\n    showFilterParentContainerRef();\n  };\n\n  let [show, setShow] = useState('block');\n  !filteredData ? show = 'none' : show = 'block'; //This function is used for getting the user with the name that matches what the user is typed in\n  //the search box once they clicked the search button close to the search input box\n\n  const searchUser = () => {\n    if (searchWord) {\n      axios.post(\"http://localhost:4000/getAllUsers\", {\n        searchInput: searchWord.toLowerCase()\n      }).then(response => {\n        console.log(response.data);\n        response.data.forEach(resData => {\n          let name = resData; //Here let check if filteredData already have this user stored in it already \n          //to avoid duplicate display of names that already exist in this array.\n\n          let checkIfThisUserExistUsingItName = filteredData.some(object => object === name);\n\n          if (!checkIfThisUserExistUsingItName) {\n            setFilteredData([{\n              name: name\n            }]);\n          }\n        });\n      }).catch(error => {\n        console.log(\"oops! Couldn't reach the server\" + error);\n      });\n    } //This shows the filters parent container SEARCH button is clicked\n\n\n    showFilterParentContainerRef();\n  }; //OPEN MESSAGE CHAT \n\n\n  const openMessageChat = () => {\n    navigate('/chatbody');\n  }; //OPEN SETTINGS FEATURE\n\n\n  const goToSettings = () => {\n    navigate('/settings');\n  }; //GO TO MY PROFILE\n\n\n  const goToProfile = () => {\n    navigate('/userprofile');\n  }; //THIS FUNCTION SAVE A PERSON TO YOUR CHATLIST IN OUR DATABASE WHEN\n  //THEY ARE BEING CLICK ON AND THEN ADD THE PERSON TO OUR CONVERSED \n  //WITH ARRAY IN OUR FRONTEND AFTER DB SAVE IS SUCCESSFUL. . . . . .\n\n\n  function saveToChatList(nameToSaveToChatList) {\n    if (loggedInNameValue && nameToSaveToChatList) {\n      axios.post(\"http://localhost:4000/saveToChatList\", {\n        loggedInUser: loggedInNameValue,\n        personToSaveToChatList: nameToSaveToChatList\n      }).then(response => {\n        //let's add the person our conversed with array\n        setConversedWithLists(prevState => [...prevState, response.data.result]);\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n  } //THIS USEEFFECT IS USED TO FETCH ALL SAVED CONVERSED WITH LIST ON EVERY PAGE RENDER\n\n\n  useEffect(() => {\n    if (loggedInNameValue) {\n      axios.post(\"http://localhost:4000/getMyChatList\", {\n        loggedInUser: loggedInNameValue\n      }).then(response => {\n        //filtering all the people in my chatlist and then putting it in my conversed with list\n        const c = response.data.filter(item => {\n          return setConversedWithLists(prevState => [...prevState, item.personToSaveToChatList]);\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n  }, []); //THIS WILL BE USED TO ADD SOMEONE TO YOUR CHATLIST WHEN THEY MESSAGE YOU\n  //AND YOU ARE PRESENTLY NOT CHATTING WITH THEM. . . . . . . . . . . . . . \n\n  useEffect(() => {\n    if (addUserToChatListValue) {\n      if (conversedWithLists.includes(addUserToChatListValue)) {} //if conversedWithList doesn't include this particular user, add the user\n      //to my chatlist.\n\n\n      if (!conversedWithLists.includes(addUserToChatListValue)) {\n        //saving this user to our chatlist database\n        saveToChatList(addUserToChatListValue);\n      }\n    }\n  }, [addUserToChatListValue]); //THIS WILL BE USED TO SHOW AVAILABLE LOCATION WHEN YOU'RE ONLINE\n\n  useEffect(() => {}, [notificationValue]); //THIS EFFECT WILL BE USED TO GET ALL YOUR AVAILABLE NOTIFICATION ON PAGE\n  //RELOAD\n\n  useEffect(() => {\n    //first let's empty the notification value\n    setNotificationValue([]);\n    axios.post(\"http://localhost:4000/getMyNotifications\", {\n      username: loggedInNameValue\n    }).then(response => {\n      response.data.forEach(resData => {\n        let addThis = resData.personToAddToNotificationList;\n        setNotificationValue(prevState => [...prevState, addThis]);\n      });\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []); //LET REMOVE THE ICON CLOSE A USER WE'RE CURRENTLY CHHATING WITH IF\n  //THEY ARE IN THE NOTIFICATION LIST...\n\n  if (notificationValue.includes(otherUserNameValue)) {\n    setNotificationValue(notificationValue.filter(i => i !== otherUserNameValue));\n  } //THIS RECEIVES MY NOTIFICATION LIST\n\n\n  useEffect(() => {\n    //Listenning for new notification and then adding it to our notification\n    //array. But first check if the person to add to notification is not the\n    //same as the current person we're chatting with which is the value \n    //otherUserNameValue variable holds\n    socket.on(\"myNotification\", data => {\n      if (data.personToAddToNotificationList !== otherUserNameValue) {\n        setNotificationValue(prevState => [...prevState, data.personToAddToNotificationList]);\n        console.log('pick up' + notificationValue);\n      }\n    });\n  }, [socket]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mobile-chat-list-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-view-top-header-parent-div\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mobile-view-top-flex\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"h2\",\n          children: \"Messages\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(FaRegBell, {\n            className: \"mobile-view-FaRegBell\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 533,\n            columnNumber: 21\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"b\", {\n            id: \"count\",\n            children: notificationValue.length\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 533,\n            columnNumber: 68\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 528,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mobile-view-search-input-div\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"mobile-view-search-input\",\n          onChange: onChangeFunction\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 542,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(FaSistrix, {\n          className: \"mobile-view-search-input-icon\",\n          onClick: searchUser\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 544,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 540,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"ul-list\",\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          onClick: goToProfile,\n          children: \"profile\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 550,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          onClick: goToSettings,\n          children: \"settings\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 551,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: loggedInNameValue ? /*#__PURE__*/_jsxDEV(FaAdn, {\n            id: \"ul-active-icon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 552,\n            columnNumber: 43\n          }, this) : 'offline'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 552,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 549,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 526,\n      columnNumber: 12\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-view-scrollable-chat-list\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mobile-view-filterAndConversewithParentDiv\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mobile-view-filterParentContainer\",\n          ref: filterParentContainerRef,\n          children: filteredData.map((filter, id) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mobile-view-filtered-user\",\n            style: {\n              display: show\n            },\n            onClick: () => {\n              if (conversedWithLists.includes(filter.name)) {} else if (!conversedWithLists.includes(filter.name)) {\n                //if user's name is not in our list of converesed with, it should\n                //add it to it.\n                saveToChatList(filter.name);\n              }\n\n              hideFilterParentContainerRef();\n            },\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mobile-view-filteredFlex\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children:\n                /*THIS CHECKS IF FILTERED USER HAS PROFILE PICTURE SO IT CAN BE DISPLAYED\r\n                  CLOSE TO THE NAME AND IF NO, IT SHOULD DISPLAY THE FIRST LETTER THAT \r\n                  BEGINS IT NAME AS THE PICTURE CLOSE TO THE NAME */\n                filter.name ? /*#__PURE__*/_jsxDEV(\"b\", {\n                  className: \"mobile-view-image-behind-filter-name\",\n                  children: String(filter.name).charAt(0)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 597,\n                  columnNumber: 44\n                }, this) : \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 592,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"mobile-view-filterName\",\n                children: filter.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 607,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 590,\n              columnNumber: 23\n            }, this)\n          }, id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 573,\n            columnNumber: 21\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 568,\n          columnNumber: 14\n        }, this), filteredData.length > 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          id: \"convo-p\",\n          children: \"CONVERSED WITH...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 623,\n          columnNumber: 41\n        }, this) : \"\", /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mobile-view-conversedWithParentContainer\",\n          children: conversedWithLists.map((conversedWithList, id) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mobile-view-conversed-user\",\n            onClick: () => {\n              {\n                /*onClick of a user in the chatlist will pass the name of the user to \r\n                the chatbody using the contextapi crafted for OtherUserNameValue*/\n              }\n              setOtherUserNameValue(conversedWithList);\n              openMessageChat(); //Removing from notification list & hiding unread message icon behind it if any.\n\n              handleRemovingThisUserFromNotificationList(conversedWithList);\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [conversedWithList ? /*#__PURE__*/_jsxDEV(\"b\", {\n                className: \"mobile-view-image-behind-conversed-name\",\n                children: String(conversedWithList).charAt(0)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 648,\n                columnNumber: 41\n              }, this) : \"\", conversedWithList]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 645,\n              columnNumber: 20\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: //Gives an alert like signal icon to indicate unread message\n              notificationValue.includes(conversedWithList) ? /*#__PURE__*/_jsxDEV(\"b\", {\n                ref: unReadRef,\n                children: /*#__PURE__*/_jsxDEV(FaExclamationCircle, {\n                  className: \"mobile-view-unreadMessageIcon\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 667,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 667,\n                columnNumber: 22\n              }, this) : \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 661,\n              columnNumber: 21\n            }, this)]\n          }, id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 630,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 626,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 565,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 561,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 524,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MobileChatList, \"Fe9R/1CzMvcLmtIEuKYMRLJxlho=\", false, function () {\n  return [useNavigate];\n});\n\n_c = MobileChatList;\nexport default MobileChatList;\n\nvar _c;\n\n$RefreshReg$(_c, \"MobileChatList\");","map":{"version":3,"names":["useContext","useEffect","useRef","useState","FaAdn","FaCheck","FaExclamationCircle","FaRegBell","FaSistrix","axios","OtherUserNameContext","MessageDisplayContext","ProfileDisplayContext","SettingsDisplayContext","useNavigate","AddUserToChatListContext","NotificationContext","socket","MobileChatList","loggedInNameValue","JSON","parse","sessionStorage","getItem","matchResult","window","matchMedia","matches","emit","smallScreenAlert","on","data","personToAddToNotificationList","otherUserNameValue","setNotificationValue","prevState","scrollableChatListRef","filterParentContainerRef","conversedWithParentContainerRef","unReadRef","hideFilterParentContainerRef","current","style","display","showFilterParentContainerRef","handleRemovingThisUserFromNotificationList","thisUser","post","loggedInUser","personToRemove","then","result","forEach","resData","addThis","notificationValue","includes","catch","err","console","log","setOtherUserNameValue","messageDisplayValue","setMessageDisplayValue","profileDisplayValue","setProfileDisplayValue","settingsDisplayValue","setSettingsDisplayValue","addUserToChatListValue","setAddUserToChatListValue","clickMessage","navigate","conversedWithLists","setConversedWithLists","filteredData","setFilteredData","searchWord","setSearchWord","onChangeFunction","event","target","value","toLowerCase","searchInput","response","name","checkIfThisUserExistUsingItName","some","object","error","show","setShow","searchUser","openMessageChat","goToSettings","goToProfile","saveToChatList","nameToSaveToChatList","personToSaveToChatList","c","filter","item","username","i","length","map","id","String","charAt","conversedWithList"],"sources":["C:/Users/HP/Desktop/coding-files/projects/web-chat-app/client/src/asset/MobileViewFolder/MobileChatList.js"],"sourcesContent":["import { useContext, useEffect, useRef, useState } from \"react\";\r\nimport { FaAdn, FaCheck, FaExclamationCircle, FaRegBell, FaSistrix } from \"react-icons/fa\";\r\nimport './MobileChatList.css';\r\nimport axios from 'axios';\r\nimport { OtherUserNameContext } from \"../contextFolder/OtherUserNameContext\";\r\nimport { MessageDisplayContext } from \"../contextFolder/MessageDisplayContext\";\r\nimport { ProfileDisplayContext } from \"../contextFolder/ProfileDisplayContext\";\r\nimport { SettingsDisplayContext } from \"../contextFolder/SettingsDisplayContext\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { AddUserToChatListContext } from \"../contextFolder/AddUserToChatListContext\";\r\nimport { NotificationContext } from \"../contextFolder/NotificationContext\";\r\nimport socket from '../SocketModuleFolder/socket';\r\n\r\nfunction MobileChatList ( ) {\r\n\r\n    //Let's get the name of the user that logged in (which is you)\r\n    //from the session storage . .  . . . . . . . . . . . . . . .\r\n    let loggedInNameValue = JSON.parse(sessionStorage.getItem(\"username\"));\r\n\r\n\r\n    //SOCKET AS DEPENDENCY FOR USEEFFECT FOR THIS COMPONENT. . . . . . . . . . . . . . . . . .\r\n    useEffect(() => {\r\n\r\n        const matchResult = window.matchMedia(\"(max-width: 767px)\");\r\n\r\n            if (matchResult.matches === true) {\r\n\r\n                socket.emit(\"small-screen-connection\", {\r\n\r\n                    smallScreenAlert: loggedInNameValue + \"is on smaller screen\"\r\n\r\n                });  \r\n            }\r\n        \r\n    }, [socket]);\r\n\r\n\r\n\r\n    //THIS RECEIVES MY   NOTIFICATION WHEN IT'S BEEN TRIGGER IN SERVER\r\n    useEffect(() => {\r\n\r\n    //Listenning for new notification and then adding it to our notification\r\n        //array. But first check if the person to add to notification is not the\r\n        //same as the current person we're chatting with which is the value \r\n        //otherUserNameValue variable holds\r\n        \r\n        socket.on(\"myNotification\", (data) => {\r\n \r\n            if (data.personToAddToNotificationList !== otherUserNameValue) {\r\n\r\n                setNotificationValue((prevState) => [...prevState, data.personToAddToNotificationList])\r\n            \r\n            }\r\n\r\n        });\r\n\r\n\r\n     }, [socket]);\r\n\r\n\r\n\r\n\r\n\r\n    \r\n\r\n\r\n    //-------- [ OUR USEREF FOR THIS COMPONENT... ] --------//\r\n\r\n    //THIS IS FOR OUR SCROLLABLE CHAT list      \r\n    const scrollableChatListRef = useRef();\r\n\r\n    //THIS IS FOR THE FILTERING OF SEARCH DIV\r\n    const filterParentContainerRef = useRef();\r\n\r\n    //THIS IS FOR THE CONVERSED WITH DIV\r\n    const conversedWithParentContainerRef = useRef();\r\n\r\n    //THIS IF HANDLING HIDING UNREAD MESSAGE ICON\r\n    const unReadRef = useRef();\r\n\r\n\r\n    //THIS HIDES THE FILTER PARENT CONTAINER DIV ONCE A USER THAT \r\n    //DISPLAY ON SEARCH LIST IS CLICKED ON . . . . . . \r\n    const hideFilterParentContainerRef = () => {\r\n\r\n        filterParentContainerRef.current.style.display = \"none\"\r\n\r\n        conversedWithParentContainerRef.style.display = \"true\"\r\n\r\n    }\r\n\r\n    //THIS SHOWS FILTERED PARENT CONTAINER WHEN YOU START SEARCHING\r\n    //FOR USER IN THE SEARCH BOX. . . . . . . . . . . . \r\n    const showFilterParentContainerRef = () => {\r\n\r\n        filterParentContainerRef.current.style.display = \"block\"\r\n\r\n   //     conversedWithParentContainerRef.style.display = \"none\"\r\n\r\n    }\r\n\r\n\r\n    //THIS REMOVES USER FROM YOUR NOTIFICATION LIST WHEN THEY ARE CLICKED\r\n    //ON . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\r\n    const handleRemovingThisUserFromNotificationList = (thisUser) => {\r\n\r\n        setNotificationValue([])//first let's empty the notification array.\r\n\r\n        //Let's then send the name of the person we want to remove to\r\n        //our DB then return the remaining people in our saved notification\r\n        //list in the database then put that value in the notification array. \r\n\r\n        \r\n        axios.post(\"http://localhost:4000/removeThisUserNotification\", {\r\n\r\n            loggedInUser: loggedInNameValue,\r\n\r\n            personToRemove: thisUser\r\n\r\n        }).then((result) => {\r\n\r\n            if (result) {\r\n\r\n                result.data.forEach((resData) => {\r\n\r\n                    let addThis = resData.personToAddToNotificationList\r\n\r\n                     //when we get the result of people in our notification list,\r\n                    //let's add them to our notification array and also (don't\r\n                    //add people that already exist in the array to prevent name\r\n                    //appearing twice which will affect the length of the array.\r\n                    //mind you, the length of the array will we used to count how\r\n                    //many notification we have . . . . . . . . . . . . . . . .)\r\n                    if ( !notificationValue.includes(addThis) ) { \r\n\r\n                    setNotificationValue((prevState) => [...prevState, addThis])\r\n\r\n                    }\r\n\r\n                });\r\n \r\n               \r\n            }\r\n            \r\n            \r\n        }).catch((err) => {\r\n\r\n            console.log(err)\r\n\r\n        });    \r\n\r\n        \r\n        //This hides the notification alert symbol icon that shows close to user\r\n        unReadRef.current.style.display = \"none\";\r\n\r\n    }\r\n\r\n\r\n   \r\n    //---------- [ CONTEXT API FOR THIS FILE... ] ----------//\r\n    const { otherUserNameValue, setOtherUserNameValue } = useContext(OtherUserNameContext) \r\n\r\n    //Displays message component when you click on list of conversed with user\r\n    const { messageDisplayValue, setMessageDisplayValue } = useContext(MessageDisplayContext)\r\n    const { profileDisplayValue, setProfileDisplayValue } = useContext(ProfileDisplayContext)\r\n    const { settingsDisplayValue, setSettingsDisplayValue } = useContext(SettingsDisplayContext)\r\n\r\n    //adding someone to your chatlist when they message you.\r\n    const { addUserToChatListValue, setAddUserToChatListValue } = useContext(AddUserToChatListContext)\r\n\r\n    //This hold the value for every notification we've. It stores the user that  \r\n    //sent use message and have'nt responded to.\r\n    const { notificationValue, setNotificationValue }  = useContext(NotificationContext)\r\n    \r\n\r\n    //If on large screen, this makes sure the message component is what is \r\n    //visible (not the profile or setting component) .  . . . . . . . \r\n    const clickMessage = () => {\r\n        setProfileDisplayValue(false)\r\n        setSettingsDisplayValue(false)\r\n        setMessageDisplayValue(true)\r\n    }\r\n\r\n\r\n    if (notificationValue) {\r\n        console.log('new chatlist' + notificationValue)\r\n    } else {\r\n        console.log(\"dont new list\")\r\n    }\r\n\r\n\r\n\r\n\r\n    /* - - - - - [ALL USESTATE FOR THIS PARTICULAR COMPONENT] - - - - - */\r\n\r\n    //This is for navigating to chat message room (when on small screen)\r\n    const navigate = useNavigate();\r\n\r\n    //This will help us storing the list of user that we've conversed with\r\n    const [conversedWithLists, setConversedWithLists] = useState([])\r\n\r\n    //This setFilteredData will store the filtered element based on the user\r\n    //search input and then store it in the filteredData variable so we can\r\n    //map it\r\n    const [filteredData, setFilteredData] = useState([])\r\n\r\n    //This is used for capturing what the user types into the search box\r\n    const [searchWord, setSearchWord] = useState();\r\n   \r\n\r\n\r\n    /* - - - - - [ALL OUR FUNCTIONS FOR THIS PARTICULAR COMPONENT] - - - - -*/\r\n\r\n    //This is to store what the user type in the search box so we can\r\n    //use for filtering and also filter the name of user in realtime \r\n    //based on serach input\r\n    const onChangeFunction = ( event ) => {\r\n\r\n        //This will grab the value in the user type in the input box and store it in the searchFilter state\r\n        //please note: the toLowerCase() will convert the value to lowercase so that it can match with the\r\n        //lowercase name properties in the database. (we'd convert all name properties in DB to lowercase too)\r\n        setSearchWord(event.target.value.toLowerCase())\r\n        \r\n        //This will filter out users that matches the character inputted by the user in realtime\r\n        //and then store it in the newFilter variable. please note: the toLowerCase() will convert the value of the\r\n        // DB name property to lowercase so that it can match with the value from the search input which we already \r\n        //convertted to lowercase using the toLowercase() method.\r\n    \r\n        //Here we're returning users that their names matches with the value the user is inputting as they\r\n        //are typing it out on the go...\r\n        \r\n        if (searchWord) {\r\n       \r\n            axios.post(\"http://localhost:4000/searchAllUsers\",{\r\n    \r\n                searchInput: searchWord.toLowerCase()\r\n                \r\n    \r\n            }).then((response) => {\r\n    \r\n                console.log(response.data)\r\n    \r\n                response.data.forEach((resData) => {\r\n    \r\n                    let name = resData;\r\n    \r\n                    //Here let check if filteredData already have this user stored in it already \r\n                    //to avoid duplicate display of names that already exist in this array.\r\n                    let checkIfThisUserExistUsingItName = filteredData.some((object) => object === name);\r\n    \r\n                   \r\n\r\n                    if (!checkIfThisUserExistUsingItName) {\r\n                        \r\n                        setFilteredData([{name: name}])\r\n                    }\r\n    \r\n                \r\n                })\r\n    \r\n        \r\n            } ).catch ( (error) => {\r\n            \r\n                console.log(\"oops! Couldn't reach the server\" + error)\r\n            \r\n            } )\r\n    \r\n        } \r\n\r\n\r\n\r\n        if (!searchWord || searchWord === \" \") {\r\n\r\n            hideFilterParentContainerRef()\r\n        }\r\n\r\n        //This shows the filters parent container whenonChange of the input search box\r\n        showFilterParentContainerRef();\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n    let [show, setShow] = useState('block')\r\n    !filteredData ? show = 'none' : show = 'block'\r\n\r\n   \r\n    //This function is used for getting the user with the name that matches what the user is typed in\r\n    //the search box once they clicked the search button close to the search input box\r\n    const searchUser = () => {\r\n   \r\n        if (searchWord) {\r\n       \r\n            axios.post(\"http://localhost:4000/getAllUsers\",{\r\n    \r\n                searchInput: searchWord.toLowerCase()\r\n                \r\n    \r\n            }).then((response) => {\r\n    \r\n                console.log(response.data)\r\n\r\n                response.data.forEach((resData) => {\r\n\r\n                    let name = resData;\r\n            \r\n                    //Here let check if filteredData already have this user stored in it already \r\n                    //to avoid duplicate display of names that already exist in this array.\r\n                    let checkIfThisUserExistUsingItName = filteredData.some((object) => object === name);\r\n    \r\n                    \r\n                    if (!checkIfThisUserExistUsingItName) {\r\n                       \r\n                        setFilteredData([{name: name}])\r\n     \r\n                     }\r\n     \r\n                  \r\n                 })\r\n     \r\n           \r\n             } ).catch ( (error) => {\r\n             \r\n                 console.log(\"oops! Couldn't reach the server\" + error)\r\n             \r\n             } )\r\n\r\n\r\n        }\r\n\r\n            //This shows the filters parent container SEARCH button is clicked\r\n            showFilterParentContainerRef()\r\n    \r\n\r\n    }\r\n\r\n\r\n    //OPEN MESSAGE CHAT \r\n    const openMessageChat = () => {\r\n\r\n        navigate('/chatbody')\r\n    }\r\n\r\n    //OPEN SETTINGS FEATURE\r\n    const goToSettings = () => {\r\n        navigate('/settings')\r\n    }\r\n\r\n    //GO TO MY PROFILE\r\n    const goToProfile = () => {\r\n        navigate('/userprofile')\r\n    }\r\n\r\n     \r\n    //THIS FUNCTION SAVE A PERSON TO YOUR CHATLIST IN OUR DATABASE WHEN\r\n    //THEY ARE BEING CLICK ON AND THEN ADD THE PERSON TO OUR CONVERSED \r\n    //WITH ARRAY IN OUR FRONTEND AFTER DB SAVE IS SUCCESSFUL. . . . . .\r\n    function saveToChatList (nameToSaveToChatList) {\r\n\r\n        if (loggedInNameValue && nameToSaveToChatList) {\r\n\r\n            axios.post(\"http://localhost:4000/saveToChatList\", {\r\n\r\n                loggedInUser:  loggedInNameValue,\r\n\r\n                personToSaveToChatList: nameToSaveToChatList\r\n\r\n            }).then((response) => {\r\n\r\n                 //let's add the person our conversed with array\r\n                setConversedWithLists((prevState) => [...prevState, response.data.result])\r\n\r\n            }).catch((err) => {\r\n\r\n                console.log(err)\r\n\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    \r\n     //THIS USEEFFECT IS USED TO FETCH ALL SAVED CONVERSED WITH LIST ON EVERY PAGE RENDER\r\n     useEffect(() => {\r\n    \r\n        if (loggedInNameValue) { \r\n\r\n            axios.post(\"http://localhost:4000/getMyChatList\", {\r\n\r\n                loggedInUser: loggedInNameValue\r\n\r\n            }).then((response) => {\r\n\r\n            //filtering all the people in my chatlist and then putting it in my conversed with list\r\n            const c = response.data.filter((item) => {\r\n\r\n                return setConversedWithLists((prevState) => [...prevState, item.personToSaveToChatList])\r\n                \r\n            })\r\n\r\n            }).catch((err) => {\r\n\r\n                console.log(err);\r\n\r\n            });\r\n\r\n        }\r\n\r\n    \r\n    }, [])\r\n\r\n\r\n    //THIS WILL BE USED TO ADD SOMEONE TO YOUR CHATLIST WHEN THEY MESSAGE YOU\r\n    //AND YOU ARE PRESENTLY NOT CHATTING WITH THEM. . . . . . . . . . . . . . \r\n    useEffect(() => {\r\n\r\n        if (addUserToChatListValue) {\r\n\r\n            if (conversedWithLists.includes(addUserToChatListValue)) {\r\n\r\n            }\r\n\r\n            //if conversedWithList doesn't include this particular user, add the user\r\n            //to my chatlist.\r\n\r\n            if (!conversedWithLists.includes(addUserToChatListValue)) {\r\n\r\n                //saving this user to our chatlist database\r\n                saveToChatList(addUserToChatListValue)\r\n\r\n            }\r\n\r\n            \r\n        }\r\n\r\n    }, [addUserToChatListValue]);\r\n\r\n\r\n\r\n\r\n\r\n    //THIS WILL BE USED TO SHOW AVAILABLE LOCATION WHEN YOU'RE ONLINE\r\n    useEffect(() => {\r\n\r\n\r\n    }, [notificationValue])\r\n\r\n\r\n\r\n\r\n\r\n\r\n    //THIS EFFECT WILL BE USED TO GET ALL YOUR AVAILABLE NOTIFICATION ON PAGE\r\n    //RELOAD\r\n    useEffect(() => {\r\n\r\n        //first let's empty the notification value\r\n        setNotificationValue([])\r\n\r\n        axios.post(\"http://localhost:4000/getMyNotifications\", {\r\n\r\n            username: loggedInNameValue\r\n\r\n        }).then((response) => {\r\n\r\n            response.data.forEach((resData) => {\r\n\r\n                let addThis = resData.personToAddToNotificationList\r\n\r\n                    setNotificationValue((prevState) => [...prevState, addThis])\r\n\r\n            });\r\n            \r\n        }).catch((err) => {\r\n\r\n            console.log(err)\r\n\r\n        });\r\n\r\n\r\n\r\n    }, [])\r\n\r\n\r\n\r\n    //LET REMOVE THE ICON CLOSE A USER WE'RE CURRENTLY CHHATING WITH IF\r\n    //THEY ARE IN THE NOTIFICATION LIST...\r\n    if (notificationValue.includes(otherUserNameValue)) {\r\n\r\n        setNotificationValue(notificationValue.filter((i) => i !== otherUserNameValue)) \r\n\r\n    }\r\n\r\n\r\n\r\n    //THIS RECEIVES MY NOTIFICATION LIST\r\n    useEffect(() => {\r\n\r\n        //Listenning for new notification and then adding it to our notification\r\n        //array. But first check if the person to add to notification is not the\r\n        //same as the current person we're chatting with which is the value \r\n        //otherUserNameValue variable holds\r\n        \r\n        socket.on(\"myNotification\", (data) => {\r\n \r\n            if (data.personToAddToNotificationList !== otherUserNameValue) {\r\n\r\n                setNotificationValue((prevState) => [...prevState, data.personToAddToNotificationList])\r\n                console.log('pick up' + notificationValue)\r\n            \r\n            }\r\n\r\n        });\r\n \r\n\r\n     }, [socket]);\r\n\r\n\r\n \r\n    return(\r\n        <div className=\"mobile-chat-list-container\" >\r\n\r\n           <div className=\"mobile-view-top-header-parent-div\">\r\n\r\n            <div className=\"mobile-view-top-flex\">\r\n\r\n                <h2 className=\"h2\">Messages</h2>\r\n\r\n                <div>\r\n                    <FaRegBell className=\"mobile-view-FaRegBell\"/> <b id=\"count\">{notificationValue.length}</b>\r\n                </div >\r\n\r\n            </div>\r\n            \r\n            {/*This is for the search user's input box*/}\r\n\r\n            <div className=\"mobile-view-search-input-div\">\r\n\r\n                <input type=\"text\" className=\"mobile-view-search-input\" onChange={onChangeFunction}></input>\r\n            \r\n                <FaSistrix className=\"mobile-view-search-input-icon\" onClick={searchUser}/>    \r\n               \r\n            </div>\r\n\r\n\r\n            <ul className=\"ul-list\">\r\n                <li onClick={goToProfile}>profile</li>\r\n                <li onClick={goToSettings}>settings</li>\r\n                <li>{ loggedInNameValue ? <FaAdn id=\"ul-active-icon\"/> : 'offline' }</li>\r\n            </ul>\r\n\r\n\r\n\r\n            </div>{/*TOP HEADER DIV END*/}\r\n\r\n        \r\n\r\n            <div className=\"mobile-view-scrollable-chat-list\">{/*SCOLLABLE DIV*/}\r\n\r\n            {/*This is for when user is searching for name. It filters the names available based on\r\n               the user query or search */}\r\n            <div className=\"mobile-view-filterAndConversewithParentDiv\">\r\n\r\n\r\n             <div className=\"mobile-view-filterParentContainer\" ref={filterParentContainerRef} >\r\n\r\n                {\r\n                    filteredData.map((filter, id) => ( \r\n\r\n                    <div key={id} className=\"mobile-view-filtered-user\" style={{display: show}} onClick={( ) => {\r\n\r\n                        if (conversedWithLists.includes(filter.name)) {\r\n\r\n                  \r\n                        } else if ( !conversedWithLists.includes(filter.name) ){\r\n\r\n                        //if user's name is not in our list of converesed with, it should\r\n                        //add it to it.\r\n                              saveToChatList(filter.name);\r\n                        }\r\n\r\n                        hideFilterParentContainerRef();\r\n                        \r\n                        }}>\r\n                      \r\n                        \r\n                      <p className=\"mobile-view-filteredFlex\" >\r\n\r\n                            <p>\r\n                            { /*THIS CHECKS IF FILTERED USER HAS PROFILE PICTURE SO IT CAN BE DISPLAYED\r\n                                CLOSE TO THE NAME AND IF NO, IT SHOULD DISPLAY THE FIRST LETTER THAT \r\n                                BEGINS IT NAME AS THE PICTURE CLOSE TO THE NAME */\r\n\r\n                            filter.name ?  <b className=\"mobile-view-image-behind-filter-name\">{ \r\n                                \r\n                                String(filter.name).charAt(0) \r\n                            \r\n                            }</b>  : \"\"\r\n\r\n                        \r\n                            }\r\n                            </p>         \r\n\r\n                            <p className=\"mobile-view-filterName\">\r\n                                {filter.name}\r\n                            </p>\r\n\r\n\r\n                        </p>\r\n\r\n                    </div>\r\n                    \r\n                    ))\r\n              \r\n                 }\r\n           \r\n             </div>{/*filterParentContainer CLOSING DIV*/}\r\n\r\n\r\n            { filteredData.length > 0 ? <p id=\"convo-p\">CONVERSED WITH...</p> : \"\" }\r\n            \r\n            {/*THIS MAPS WHO YOU HAVE CONVERSED WITH. IT SHOWS ALL THE LIST*/}\r\n            <div className=\"mobile-view-conversedWithParentContainer\">\r\n               { \r\n                conversedWithLists.map((conversedWithList, id) => ( \r\n\r\n                <div key={id}  className=\"mobile-view-conversed-user\" onClick={ ( ) => {\r\n\r\n                   {/*onClick of a user in the chatlist will pass the name of the user to \r\n                    the chatbody using the contextapi crafted for OtherUserNameValue*/} \r\n                  \r\n                    setOtherUserNameValue(conversedWithList);\r\n\r\n                    openMessageChat();\r\n\r\n                    //Removing from notification list & hiding unread message icon behind it if any.\r\n                    handleRemovingThisUserFromNotificationList(conversedWithList)\r\n\r\n                   \r\n                }}>\r\n                    \r\n                   <p> \r\n                    { \r\n                    \r\n                    conversedWithList ? <b className=\"mobile-view-image-behind-conversed-name\">{ \r\n\r\n                        String(conversedWithList).charAt(0) \r\n\r\n                    }</b> : \"\"\r\n\r\n                    }  \r\n\r\n                        { conversedWithList }\r\n                        \r\n                    </p>\r\n\r\n\r\n                    <p>\r\n                    {\r\n                    \r\n                    //Gives an alert like signal icon to indicate unread message\r\n                     notificationValue.includes(conversedWithList) ? \r\n                     \r\n                     <b ref={unReadRef}><FaExclamationCircle className=\"mobile-view-unreadMessageIcon\"/></b> : \"\"\r\n\r\n                    }\r\n                    </p>\r\n\r\n                   \r\n                </div>\r\n                \r\n                ))\r\n            }  \r\n\r\n        </div>{/*ConversedwithParentContainer CLOSING DIV*/}\r\n\r\n\r\n\r\n        </div>{/*filterAndConversewithParentDiv CLOSING DIV*/}\r\n\r\n\r\n        </div>{/*SCROLLABLE DIV CLOSING DIV*/}    \r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default MobileChatList;"],"mappings":"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"},"metadata":{},"sourceType":"module"}